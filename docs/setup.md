# Проект CodeW — стартовый каркас

Этот репозиторий содержит заготовку для продукта CodeW на базе Next.js 15 с App Router, TypeScript, Material UI, Prisma и инструментария для контроля качества кода.

## Требования

- Node.js 20 LTS или выше (в проекте тестировалось на Node 22)
- Yarn 4 (Berry) — поставляется вместе с Corepack (`corepack enable`)
- SQLite (встроенный движок prisma, отдельная установка не требуется)

## Быстрый старт

```bash
# Установка зависимостей
yarn install

# Подготовка переменных окружения
cp .env.example .env

# Генерация клиентских типов и базы данных
yarn prisma:db-push

# Запуск приложения в dev-режиме
yarn dev
```

Приложение будет доступно по адресу <http://localhost:3000>.

> Production-сборка (`yarn build`) автоматически удаляет локальный файл `prisma/dev.db` и заново создаёт его на основе схемы.

## Скрипты Yarn

| Скрипт                 | Назначение                                                |
| ---------------------- | --------------------------------------------------------- |
| `yarn dev`             | Запуск Next.js dev-сервера.                               |
| `yarn build`           | Сборка production-версии приложения с пересозданием dev-базы. |
| `yarn start`           | Запуск собранного приложения.                             |
| `yarn lint`            | Проверка ESLint во всем репозитории.                      |
| `yarn lint:fix`        | Автоматическое исправление обнаруженных замечаний ESLint. |
| `yarn format`          | Форматирование файлов с помощью Prettier.                 |
| `yarn format:check`    | Проверка форматирования без внесения изменений.           |
| `yarn prisma:generate` | Генерация Prisma Client.                                  |
| `yarn prisma:db-push`  | Применение схемы Prisma к SQLite dev-базе.                |

## Husky и lint-staged

Перед каждым коммитом автоматически выполняется `lint-staged`, который запускает ESLint и Prettier для затронутых файлов. При наличии ошибок коммит будет остановлен.

## Настройка Prisma

- Схема хранится в `prisma/schema.prisma` и использует SQLite с файлом `dev.db` в директории `prisma/`. Файл добавлен в `.gitignore`
  и пересоздаётся автоматически.
- После изменения схемы выполните `yarn prisma:db-push` для обновления базы и генерации клиента. Команда скачивает движки Prisma с `binaries.prisma.sh`, убедитесь, что есть доступ в интернет.
- В офлайн-средах можно указать зеркало с помощью переменной `PRISMA_ENGINES_MIRROR` или отключить проверку контрольных сумм через `PRISMA_ENGINES_CHECKSUM_IGNORE_MISSING=1`.
- Для проверки данных можно использовать `yarn prisma studio` через `yarn dlx prisma studio` (опционально).

## Структура темизации MUI

- Тема определяется в `src/theme/index.ts`.
- Провайдер темы подключён в `src/app/layout.tsx` через компонент `AppThemeProvider`.
- Пример использования компонент Material UI доступен на главной странице `src/app/page.tsx`.

## Smoke-checklist

| Статус | Проверка                   | Команда               |
| ------ | -------------------------- | --------------------- |
| ✅     | Линт без ошибок            | `yarn lint`           |
| ✅     | Успешная сборка            | `yarn build`          |
| ✅     | Dev-сервер запускается     | `yarn dev`            |
| ⚠️     | Синхронизация схемы Prisma | `yarn prisma:db-push` |

> Примечание: для запуска dev-сервера в первый раз убедитесь, что база данных создана командой `yarn prisma:db-push`.
